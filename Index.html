<!DOCTYPE html>
<html>

<head>
  <title>Screenshot Effect</title>
  <style>
    #imageContainer {
      width: 500px;
      /* Adjust as needed */
      height: auto;
      border: 1px solid #ccc;
      overflow: hidden;
      /* Hide excess image due to scaling */
    }

    #imageContainer img {
      width: 100%;
      height: auto;
    }
  </style>
</head>

<body>
  <input type="file" id="imageUpload" accept="image/*">
  <input type="number" id="iterations" min="1" value="1">
  <button id="applyEffect">Apply Effect</button>

  <div id="imageContainer"></div>

  <script>
    const imageUpload = document.getElementById('imageUpload');
    const iterationsInput = document.getElementById('iterations');
    const applyEffectButton = document.getElementById('applyEffect');
    const imageContainer = document.getElementById('imageContainer');

    applyEffectButton.addEventListener('click', () => {
      const file = imageUpload.files[0];
      const iterations = parseInt(iterationsInput.value);

      if (file) {
        const reader = new FileReader();

        reader.onload = (e) => {
          const img = document.createElement('img');
          img.src = e.target.result;

          imageContainer.innerHTML = ''; // Clear previous image
          imageContainer.appendChild(img);

          applyScreenshotEffect(img, iterations);
        }

        reader.readAsDataURL(file);
      }
    });

    function applyScreenshotEffect(img, iterations) {
      let currentImage = img;

      for (let i = 0; i < iterations; i++) {
        currentImage = createScreenshot(currentImage);
      }

      imageContainer.innerHTML = '';
      imageContainer.appendChild(currentImage);
    }

    function createScreenshot(img) {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');

      const padding = 20; // Space between image and window frame
      const borderWidth = 10; // Width of the window border

      canvas.width = img.width + (padding + borderWidth) * 2;
      canvas.height = img.height + (padding + borderWidth) * 2 + 30; // Add space for title bar

      // Draw window frame (simple example, you can customize this)
      ctx.fillStyle = '#f0f0f0'; // Window background color
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#ccc'; // Title bar color
      ctx.fillRect(0, 0, canvas.width, 30); // Title bar
      ctx.strokeStyle = '#000'; // Border color
      ctx.lineWidth = borderWidth;
      ctx.strokeRect(borderWidth, 30 + borderWidth, canvas.width - borderWidth * 2, canvas.height - borderWidth * 2 - 30);

      // Draw image inside the frame
      ctx.drawImage(img, padding + borderWidth, padding + borderWidth + 30);

      const newImg = document.createElement('img');
      newImg.src = canvas.toDataURL('image/jpeg', 0.9); // Re-encode as JPEG
      return newImg;
    }
  </script>
</body>

</html>
